This is a copy from master branch but this is modified by Eli pogi
